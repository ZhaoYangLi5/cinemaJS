<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <meta name="mobileoptimized" content="0"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="screen-orientation" content="portrait">
    <meta name="browsermode" content="application">
    <title></title>
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
<div class="scence scence-1">
    <div class="bg a-bg"></div>
    <div class="bg a-bg-mask"></div>
</div>
<div class="scence scence-2">
    <div class="bg b-bg"></div>
    <div class="bg b-bg-mask"></div>
</div>
<div class="scence scence-3">
    <div class="bg c-bg"></div>
    <div class="bg c-bg-mask"></div>
    <div class="door-up"></div>
    <div class="door-down"></div>
</div>
<script src="../../lib/package.js"></script>
<script>
    main( function () {
        var insertCSS = imports( "../../lib/css.js" ).insertCSSRules;
        var Scence = imports( "../../lib/cinema.js" ).Scence;
        var util = imports( "../../lib/util.js" );

        var TimeLine = [];
        var scences = document.querySelectorAll( ".scence" );

        insertCSS( {
            ".bg.b-bg-mask" : {
                width : document.body.offsetHeight / 1008 * 1417 + "px"
            }
        } );

        util.loopArray( scences, function ( s, i ) {
            TimeLine.push( new Scence( {
                el : s,
                lifeTime : 4
            } ) );
            document.body.removeChild( s );
        } );


        var curindex = 0;

        function play() {
            function playOneScence() {
                TimeLine[curindex].born();
                document.body.appendChild( TimeLine[curindex].el );
                setTimeout( function () {
                    document.body.removeChild( TimeLine[curindex].el );
                    TimeLine[curindex].el.classList.remove( "born" );
                    curindex = (curindex + 1) % TimeLine.length;
                    playOneScence();
                }, TimeLine[curindex].lifeTime * 1000 );
            }

            playOneScence();
        }

        play();
    } );
</script>
</body>
</html>